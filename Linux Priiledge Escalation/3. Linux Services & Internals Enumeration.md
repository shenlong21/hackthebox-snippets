## Try to answer these questions:
 - What services and applications are installed?
 - What services are running?
 - What sockets are in use?

 - What users, admins, and groups exist on the system?

 - Who is current logged in? What users recently logged in?

 - What password policies, if any, are enforced on the host?

 - Is the host joined to an Active Directory domain?

 - What types of interesting information can we find in history, log, and backup files

 - Which files have been modified recently and how often? Are there any interesting patterns in file modification that could indicate a cron job in use that we may be able to hijack?

 - Current IP addressing information

 - Anything interesting in the /etc/hosts file?

 - Are there any interesting network connections to other systems in the internal network or even outside the network?

  - What tools are installed on the system that we may be able to take advantage of? (Netcat, Perl, Python, Ruby, Nmap, tcpdump, gcc, etc.)

  - Can we access the bash_history file for any users and can we uncover any thing interesting from their recorded command line history such as passwords?

  - Are any Cron jobs running on the system that we may be able to hijack?

## Checking for the internals
### 1. Network Interfaces

```bash
ip a
```

### 2. Hosts

```bash
cat /etc/hosts
```

### 3. User's Last Login

```bash
lastlog
```
 
### 4. For the people who are loggin in at this time

```bash
who, finger, w
```

### 5. Command History

```bash
history
```

### 6. Finding History Files

```bash
find / -type f \( -name *_hist -o -name *_history \) -exec ls -l {} \; 2>/dev/null

# -rw------- 1 htb-student htb-student 387 Nov 27 14:02 /home/htb-student/.bash_history
```

### 7. Checking for SUID binaries

```bash
find / -perm -u=s -type f 2>/dev/null
```

### 8. Checking for Sticky Bit Files

```bash
find / -perm -g=s -type f 2>/dev/null
```

### 9. Checking for World Writable Files

```bash
find / -perm -o=w -type f 2>/dev/null
# find / -path /proc -prune -o -path /sys -prune -o -perm -o=w -type f 2>/dev/null
```
 
### 10. Cron

```bash
ls -la /etc/cron.daily/
```

### Proc

```bash
find /proc -name cmdline -exec cat {} \; 2>/dev/null | tr " " "\n"
```

### Installed Packages

```bash
apt list --installed | tr "/" " " | cut -d" " -f1,3 | sed 's/[0-9]://g' | tee -a installed_pkgs.list
```

### Sudo Version
 
```bash
sudo -V
```


 Occasionally it can also happen that no direct packages are installed on the system but compiled programs in the form of binaries. These do not require installation and can be executed directly by the system itself.

### Binaries
 
```bash
ls -l /bin /usr/bin/ /usr/sbin/
```

### Proc

```bash
find /proc -name cmdline -exec cat {} \; 2>/dev/null | tr " " "\n"
```

### Installed Packages

```bash
apt list --installed | tr "/" " " | cut -d" " -f1,3 | sed 's/[0-9]://g' | tee -a installed_pkgs.list
```

### Sudo Version
```bash 
sudo -V
```


### Binaries: Check for all the binaries installed
```bash 
ls -l /bin /usr/bin/ /usr/sbin/
```

### GTFObins
```bash 
for i in $(curl -s https://gtfobins.github.io/ | html2text | cut -d" " -f1 | sed '/^[[:space:]]*$/d');do if grep -q "$i" installed_pkgs.list;then echo "Check GTFO for: $i";fi;done
```


### Configuration Files
Check for all readable config files
```bash 
find / -type f \( -name *.conf -o -name *.config \) -exec ls -l {} \; 2>/dev/null
```

### Similarly the script files Scripts
```bash 
find / -type f -name "*.sh" 2>/dev/null | grep -v "src\|snap\|share" 
```

### Running Services by User
```bash 
ps aux | grep root
```