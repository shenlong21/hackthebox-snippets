# Environment Enumeration

### Gaining Situational Awareness: Must
Typically we'll want to run a few basic commands to orient ourselves:

 - whoami - what user are we running as
 - id - what groups does our user belong to?
 - hostname - what is the server named, can we gather anything from the naming convention?
 - ifconfig or ip a - what subnet did we land in, does the host have additional NICs in other subnets?
 - sudo -l - can our user run anything with sudo (as another user as root) without needing a password? This can sometimes be the easiest win and we can do something like sudo su and drop right into a root shell.


1. We'll start out by checking out what operating system and version we are dealing with.

### Environment Enumeration

```bash
cat /etc/os-release
```

### Use these:

```bash
cat /etc/os-release
echo $PATH
env
uname -a
lscpu
cat /etc/shells
```

We should also check to see if any defenses are in place and we can enumerate any information about them. Some things to look for include:

Exec Shield
iptables
AppArmor
SELinux
Fail2ban
Snort
Uncomplicated Firewall (ufw)

```bash
lsblk
lpstat
cat /etc/fstab
route or netstat -rn.
arp -a
```

### Checking domain

```bash
/etc/resolv.conf for 
```

### Check for all the users available in the system

```bash
cat /etc/passwd | cut -f1 -d:
```

Algorithm	Hash
Salted MD5	$1$...
SHA-256	$5$...
SHA-512	$6$...
BCrypt	$2a$...
Scrypt	$7$...
Argon2	$argon2i$...


### Check for users having shells: 

```bash
grep "sh$" /etc/passwd
```

Can use the info previously obtained for all the shells available in the system and here to map and check for the version to be able to exploit them.


### Check for the users in the groups from /etc/group file

```bash
getent group sudo
```

### Check for all the users having a home directory: 

```bash
cat /etc/passwd | cut -f1 -d: | xargs -I {} bash -c 'if [ -d "/home/{}" ]; then echo "{}"; fi'
```

> try to read the bash_history file of any user to be containing sensitive insformation.

> check for the ssh keys available:  potentially to escalate privileges, or to assist with pivoting and port forwarding further into the internal network.

> check the ARP cache to see what other hosts are being accessed and cross-reference these against any useable SSH private keys.

### Check for the mounted filesystems

```bash 
df -h
```

### Unmounted File Systems

```bash 
cat /etc/fstab | grep -v "#" | column -t
```

### All Hidden Files

```bash
find / -type f -name ".*" -exec ls -l {} \; 2>/dev/null | grep htb-student
```

### All Hidden Directories

```bash
find / -type d -name ".*" -ls 2>/dev/null
```

### Temporary Files

```bash
ls -l /tmp /var/tmp /dev/shm
```